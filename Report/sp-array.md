## 部分永続配列
### 2018年8月7日

バージョン管理ができる配列みたいなもの．
更新は最新バージョンに対してのみだが，過去のバージョンにもアクセスできる．

連想配列の配列$\langle a_1, a_2, \dots\rangle$を持っておく．
バージョン$t$で添字$i$の値を$v$にするとき，$a_i$に対応付け$t\mapsto v$を追加する．
前回の更新バージョン$t'$と今回の更新バージョン$t$に対して$t'\le t$が成り立つように確認する．

バージョン$t$での添字$i$の値は，$a_i$において$t'\le t$を満たす最大の$t'$に対応付けられた値である．
これは（当然）二分探索で求められる．
まず$a_i$内の最大のキー$t_\mathrm{max}$とクエリ$t$を比較して，$t_\mathrm{max}\le t$なら$a_i(t_\mathrm{max})$を返すようにすると，最新バージョンについては$O(1)$で答えられる．
また，番兵として$0\mapsto v_\mathrm{init}$をすべての$a_i$に入れておくと実装が楽かも．

`std::map<size_t, T>`を使うなら（バージョンが単調非減少なので）`.emplace_hint(.end(), t, v)`をすると更新が$O(1)$になってくれそう．
自分で実装した時はそれに気付かなかったので`std::vector<std::pair<size_t, T>>`でやってしまった．